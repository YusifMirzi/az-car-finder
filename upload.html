<!DOCTYPE html>
<html lang="az">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>Ma≈üƒ±n …ôlav…ô et</title>
<link rel="stylesheet" href="style.css"/>
</head>
<body>

<div class="container">
  <h1>üöó Ma≈üƒ±n …ôlav…ô et</h1>
  <input id="plateUpload" placeholder="99-AA-999"/>
  <input id="brandUpload" placeholder="Marka"/>
  <input id="modelUpload" placeholder="Model"/>
  <input id="colorUpload" placeholder="R…ông"/>
  <input id="imageFile" type="file" accept="image/*"/>
  <button onclick="uploadCar()">∆èlav…ô et</button>
  <p id="uploadStatus"></p>
  <p><a href="index.html">Axtarƒ±≈ü s…ôhif…ôsin…ô qayƒ±t</a> | <a href="gallery.html">B√ºt√ºn ma≈üƒ±nlarƒ± g√∂r</a></p>
</div>

<script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore-compat.js"></script>

<script>
  const firebaseConfig = {
    apiKey: "AIzaSyA6_KRvzWOnugniooEVU2mYwyS4dQVEigg",
    authDomain: "az-car-finder.firebaseapp.com",
    projectId: "az-car-finder",
    appId: "1:57523334386:web:92894db01eb5eb64f0b46b"
  };

  firebase.initializeApp(firebaseConfig);
  const db = firebase.firestore();

  async function uploadCar() {
    const plate = document.getElementById("plateUpload").value.toUpperCase();
    const brand = document.getElementById("brandUpload").value;
    const model = document.getElementById("modelUpload").value;
    const color = document.getElementById("colorUpload").value;
    const fileInput = document.getElementById("imageFile");
    const file = fileInput.files[0];

    if (!plate || !brand || !model || !color || !file) {
      document.getElementById("uploadStatus").innerText = "B√ºt√ºn sah…ôl…ôri doldurun!";
      return;
    }

    const formData = new FormData();
    formData.append("file", file);
    formData.append("upload_preset", "azcarfinder"); // your preset
    const cloudName = "dk0e3f7vc"; // your Cloud Name
    const uploadUrl = `https://api.cloudinary.com/v1_1/${cloudName}/upload`;

    document.getElementById("uploadStatus").innerText = "≈û…ôkil y√ºkl…ônir...";

    const response = await fetch(uploadUrl, {
      method: "POST",
      body: formData
    });

    const data = await response.json();
    const imageUrl = data.secure_url;

    if (!imageUrl) {
      document.getElementById("uploadStatus").innerText = "≈û…ôkil y√ºkl…ônm…ôdi, yenid…ôn c…ôhd edin.";
      return;
    }

    await db.collection("cars").doc(plate).set({
      brand,
      model,
      color,
      image: imageUrl
    });

    document.getElementById("uploadStatus").innerText = "Ma≈üƒ±n …ôlav…ô olundu!";
  }
</script>

</body>
</html>
